<meta charset="UTF-8">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/water.css@2/out/water.css">
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
<script type="text/javascript" src="./js/crypto.js"></script>

<label for="target">署名対象</label>
<input id="target" name="target"></input>

<br />

<label for="signature">署名</label>
<input id="signature" name="signature"></input>

<br />

<label for="pubkey">公開鍵</label>
<input id="pubkey" name="pubkey"></input>
<br />

<button onclick="run()">検証</button>
<br />

<label for="result">検証結果</label>
<input id="result" name="target" readonly></input>


<script>
    const signature = document.getElementById('signature')
    const target = document.getElementById('target')
    const pubkey = document.getElementById('pubkey')
    const result = document.getElementById('result')

    const run = async () => {
        const rawPriv = await decodeKeyForSignature(pubkey.value, 'spki', "verify")
        result.value = await verify(signature.value, target, rawPriv)
    }
</script>